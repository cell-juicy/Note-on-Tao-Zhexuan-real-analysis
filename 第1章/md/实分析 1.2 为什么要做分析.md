# 1.2 为什么要做分析

[toc]

## 前言

在微积分的课程之中，我们已经学习过了微积分基础理论的应用，这一节里我们将给出几个例子，了解当不知晓法则的由来而只知道应用的时候可能带来的危害。因此，即使是早已了然于心的的规则，我们也需要了解其背后的分析原理，保证不会引发某些灾难性后果。

看下面这些例子，不妨思考下这些例子的问题出在哪里，这些问题都将在本书的学习中获得解答。

## 例子

### 例1.2.1 用$0$做除数

这是一个非常常见的例子。当$c=0$时，消去律$ac=bc\iff a=b$不成立，比如有$1\times 0=2\times 0$，如果这时使用消去律就会得到$1=2$的荒谬结果，这个例子里我们很明显能看到是因为使用了$0$做除数，但是在一些别的情况下，这样的错误可能是隐蔽的而难以轻易察觉。

---

### 例1.2.2 发散级数

你可能见过下面这样的级数：
$$
S=1+\frac{1}{2}+\frac{1}{4}+\frac{1}{8}+...
$$
或许你曾在某些地方听过这样的技巧来巧妙的求解这个级数：令该级数和为$S$，于是将等号两端同时乘以$2$就可以得到：
$$
2S=2+1+\frac{1}{2}+\frac{1}{4}+...=2+S
$$
于是可以求解得到$S=2$。

这看起来是个非常简洁易懂的方法，但是当我们应用这个方法到另一个级数上时：
$$
\begin{array}{c}
S=1+2+4+8+...\\
\Downarrow\\
2S=2+4+8+16+...=S-1\\
\Downarrow\\
S=-1
\end{array}
$$
显然这样的结论是违背我们常识的，那么这样的操作问题究竟出在哪里？

另一个例子就是下面这个级数：
$$
S=1-1+1-1+...
$$
按照上面的方法，我们可以有：
$$
1-S=S\iff S=\frac{1}{2}
$$
但是我们也可以将上面的级数写作另一种形式：
$$
S=(1-1)+(1-1)+...=0+0+0+...=0
$$
又或者：
$$
S=1-(1-1)-(1-1)-...=1-0-0-...=1
$$
上面的这三种说法，哪一个是对的？<font color=blue>（答案在[习题7.2.1](..\..\第7章\md\实分析 7.2 无限级数.md)）</font>

---

### 例1.2.3 发散序列

取$x$是实数，$L$表示极限：
$$
L=\lim_{n\to\infty}x^n
$$
做变量替换$n=m+1$，于是有：
$$
L=\lim_{m+1\to\infty}x^{m+1}=\lim_{m+1\to\infty}(x^{m}x)=x\lim_{m+1\to\infty}x^{m}
$$
若$m+1\to\infty$，则$m\to\infty$，于是上式可以有：
$$
L=x\lim_{m+1\to\infty}x^{m}=x\lim_{m\to\infty}x^{m}=xL
$$
于是左右消去$L$，我们可以得到对任何实数$x$，$x=0$，这样的结论显然是荒谬的。

当然，我们也可以说$L=0$，这样上面的消去律使用就是不恰当的，这样似乎给出了个合理的解释，即对任意实数$x$，$\displaystyle\lim_{n\to\infty}x^n=0$恒成立。但是对于一些实数$x$<font color=blue>（比如$x=1$）</font>，这样的结论依然是荒谬的，上面的论证出现了什么问题？<font color=blue>（答案在[习题6.3.4](..\..\第6章\md\实分析 6.3 序列的上确界与下确界.md)）</font>

---

### 例1.2.4 函数的极限值

对于极限表达式$\displaystyle L=\lim_{x\to\infty}\sin(x)$，我们做变量替换$y=x+\pi$，可以得到：
$$
L=\lim_{x\to\infty}\sin(x)=\lim_{y+\pi\to\infty}\sin(y+\pi)=\lim_{y\to\infty}(-\sin(y))=-\lim_{y\to\infty}\sin(y)=-L
$$
于是可以得到$L=-L=0$，同时，我们还可以做变量替换$\displaystyle z=x+\frac{\pi}{2}$，于是我们又可以得到：
$$
\lim_{z\to\infty}\cos(z)=0
$$
于是对上述两个极限求平方相加，可以得到：
$$
\lim_{x\to\infty}\left(\sin(x)^2+\cos(x)^2\right)=0
$$
但是我们又有$\sin(x)^2+\cos(x)^2=1$恒成立，于是我们得到了惊人的结论即$1=0$<font color=blue>（数学大厦的崩塌（实分析ver）.jpg）</font>，上面的论证究竟哪里出现了问题？

---

### 例1.2.5 交换求和次序

我们考虑有关运算的如下事实。对任意的数值矩阵，例如：
$$
\begin{pmatrix}1&2&3\\4&5&6\\7&8&9\end{pmatrix}
$$
计算该矩阵每一行以及每一列元素之和，然后分别把所有行的和相加、所有列的和相加。最后，你会发现上述两种运算的结果是相等的——都等于矩阵中所有元素相加的和：
$$
\begin{matrix}\begin{pmatrix}1&2&3\\4&5&6\\7&8&9\end{pmatrix}\\12\ \ 15\ \ 18&\\&\\&\end{matrix}\begin{matrix}6\\15\\24\\45\\ \\ \\ \end{matrix}
$$
换言之，如果你想要将一个$m\times n$矩阵中的所有元素相加，那么不管你是先把每一行的元素加起来，还是先把每一列的元素加起来，最后得到的结果都是一样的。（在计算机被发明出来之前，会计师和簿记员在结算账目的时候，都会采用这种方法来避免错误。）用级数的概念来描述以上事实即为：
$$
\sum_{i=1}^{m}\sum_{j=1}^{n}a_{ij}=\sum_{j=1}^{n}\sum_{i=1}^{m}a_{ij}
$$
其中，$a_{ij}$表示矩阵的第$i$行第$j$列元素。

现在，有人可能会认为上述结论应该很容易推广到无穷级数：
$$
\sum_{i=1}^{\infty}\sum_{j=1}^{\infty}a_{ij}=\sum_{j=1}^{\infty}\sum_{i=1}^{\infty}a_{ij}
$$
实际上，如果你在工作中很多地方都会用到无穷级数，那么你会发现之间经常像这样通过变换次序来求和。也就是说，在一个无穷矩阵中，行和相加的结果与列和相加的结果是一样的。然而，尽管这种说法听起来合理，但他实际上是错误的！这里给出一个反例：
$$
\begin{pmatrix}1&0&0&0&\cdots\\-1&1&0&0&\cdots\\0&-1&1&0&\cdots\\0&0&-1&1&\cdots\\0&0&0&-1&\cdots\\\vdots&\vdots&\vdots&\vdots&\ddots\end{pmatrix}
$$
如果你对该矩阵每一行元素求和，然后将得到的所有行和相加，那么你会得到$1$。但是，如果你对该矩阵每一列元素求和，然后将得到的所有列和相加，那么你会得到$0$！因此，这是否意味着对无穷级数求和不能采用交换次序的方法，而且任何采用交换次序方法所得到的结论都是不可信的？<font color=blue>（答案见[定理8.2.2](..\..\第8章\md\实分析 8.2 在无限集上求和.md)）</font>

------

### 例1.2.6 交换积分次序

交换积分次序与交换求和次序一样，都是数学中很常见的运算技巧。假设我们想要计算某个曲面$z=f(x,y)$之下的体积<font color=blue>（此处我们暂时不考虑积分上下限）</font>。一种方法是平行于$x$轴进行切割：对任意给定的$y$，我们能够计算出与之对应的一部分面积为$\displaystyle \int f(x,y)\text dx$，然后我们把这部分以$y$为变量的面积进行积分就得到了要求的体积：
$$
V=\iint f(x,y)\text dx\text dy
$$
或者，对任意给定的$y$，我们也可以平行于$y$轴进行切割，并且计算出与$x$对应的一部分面积为$\displaystyle\int f(x,y)\text dy$，任何沿$x$轴对上述面积进行积分，从而得到体积为：
$$
V=\iint f(x,y)\text dy\text dx
$$
这似乎表明我们可以通过交换积分号来运算：
$$
\iint f(x,y)\text dx\text dy=\iint f(x,y)\text dy\text dx
$$
事实上，因为有时先对某个变量进行积分要比先对其他变量进行积分更加容易，所以人们往往采用交换积分号的方法来运算。但是，正如前文中对无穷个元素求和有时不能交换求和次序一样，交换积分号的方法来运算。但是，正如前文中对无穷个元素求和时不能交换求和次序一样，交换积分号的运算有时也会存在分险。下面给出一个关于被积函数$e^{-xy}-xye^{-xy}$的例子。假设该积分是可以交换积分号的：
$$
\begin{align}&\int^{+\infty}_{0}\int^{1}_{0}(e^{-xy}-xye^{-xy})\text dy\text dx=\int^{1}_{0}\int^{+\infty}_{0}(e^{-xy}-xye^{-xy})\text dx\text dy &(1.1)\end{align}
$$
因为：
$$
\int^{1}_{0}(e^{-xy}-xye^{-xy})\text dy=\left.ye^{-xy}\right|^{y=1}_{y=0}=e^{-x}
$$
所以式$(1.1)$的等号左侧表达式为$\displaystyle \int^{\infty}_{0}e^{-x}\text dx=-e^{-x}|_{0}^{\infty}=1$。但是，又因为：
$$
\int^{\infty}_{0}(e^{-xy}-xye^{-xy})\text dy=\left.xe^{-xy}\right|^{x=\infty}_{x=0}=e^{-x}=0
$$
所以式$(1.1)$的等号右侧表达式为$\displaystyle \int^{1}_{0}0\;\text dy=0$。显然$1\ne0$因此上文中的某处存在错误；然而你会发现，除了交换积分号这一步骤，上面的过程并不存在其他的错误。那么，我们如何判断什么时候可以放心地进行交换积分次序的运算呢？<font color=blue>（[定理19.5.1](..\..\第19章\md\实分析 19.5 富比尼定理.md)会给出部分答案） </font>

------

### 例1.2.7 交换极限运算次序

我们考虑下面这个看似正确的表达式：
$$
\begin{align}&\lim_{x\to 0}\lim_{y\to 0}\frac{x^2}{x^2+y^2}=\lim_{y\to 0}\lim_{x\to 0}\frac{x^2}{x^2+y^2}&(1.2)\end{align}
$$
因为我们有
$$
\lim_{y\to 0}\frac{x^2}{x^2+y^2}=\frac{x^2}{x^2+0^2}=1
$$
因此，式$(1.2)$等号右侧表达式等于$1$；由于$1$显然不等于$0$，所以这表明了交换极限运算次序是不可信的。然而，是否存在某些情况，交换极限运算次序能够成立呢？<font color=blue>（[习题14.3.2](..\..\第14章\md\实分析 14.3 一致收敛性与连续性.md)给出了部分答案）</font>

------

### 例1.2.8 再谈交换极限运算次序

考虑如下貌似正确的表达式：
$$
\lim_{x\to 1^-}\lim_{n\to \infty}x^n=\lim_{n\to \infty}\lim_{x\to 1^-}x^n
$$
其中，记号$x\to 1^-$表示$x$从$1$的左侧趋向于$1$。当$x$在$1$的左侧时，$\lim\limits_{n\to \infty}x^n=0$，因此上面等式的左端等于$0$。但是对于任意给定的$n$，我们总可以得到$\lim\limits_{x\to 1^-}x^n=1$。因此，上面等式右端的极限为$1$。这是否意味着这种类型的极限运算次序交换都是不可信的？<font color=blue>（答案见[命题14.3.3](..\..\第14章\md\实分析 14.3 一致收敛性与连续性.md)）</font>

------

### 例1.2.9 交换极限运算与积分运算的次序

对任意的实数$y$，我们有
$$
\int^{+\infty}_{-\infty}\frac{\text dx}{1+(x-y)^2}=\left.\arctan(x-y)\right|^{x=+\infty}_{x=-\infty}=\frac{\pi}{2}-\left(-\frac{\pi}{2}\right)=\pi
$$
当$y\to \infty$时取极限，我们可以得到：
$$
\int^{+\infty}_{-\infty}\lim_{y\to \infty}\frac{\text dx}{1+(x-y)^2}=\lim_{y\to \infty}\int^{+\infty}_{-\infty}\frac{\text dx}{1+(x-y)^2}=\pi
$$
但是对于任意$x$，我们有$\displaystyle \lim_{y\to \infty}\frac{\text dx}{1+(x-y)^2}=0$。因此，我们似乎可以推导出$0=\pi$。上述论证出现了什么问题？是否应该舍弃（非常有用的）交换极限运算与积分运算次序的技巧？<font color=blue>（[定理14.6.1](..\..\第14章\md\实分析 14.6 一致收敛和积分.md)给出了部分答案）</font>

------

### 例1.2.10 交换极限运算与求导运算的次序

观察可知，如果$\varepsilon>0$，则有
$$
\frac{\text d}{\text dx}\left(\frac{x^3}{x^2+\varepsilon^2}\right)=\frac{3x^2(x^2+\varepsilon^2)-2x^2}{x^2+\varepsilon^2}
$$
特别的，
$$
\left.\frac{\text d}{\text dx}\left(\frac{x^3}{x^2+\varepsilon^2}\right)\right|_{x=0}=0
$$
当$\varepsilon\to 0$时取极限，我们期望得到：
$$
\left.\frac{\text d}{\text dx}\left(\frac{x^3}{x^2+0}\right)\right|_{x=0}=0
$$
但是该式左端为：$\displaystyle \frac{\text d}{\text dx}x=1$。那么，这是否表明交换极限运算和求导运算的次序总是错误的？<font color=blue>（答案见[定理14.7.1](..\..\第14章\md\实分析 14.7 一致收敛和导数.md)）</font>

------

### 例1.2.11 交换求导次序

定义$f(x,y)$为下列函数：$\displaystyle f(x,y) ：=\frac{xy^3}{x^2+y^2}$<font color=blue>（可能有人提出这样的质疑，函数$f(x,y)$在$(x,y)=(0,0)$处没有定义。但是如果我们规定$f(0,0):=0$，那么该函数对任意的$(x,y)$都是连续且可微的；并且事实上，偏导数$\displaystyle \frac{\partial f}{\partial x}$与$\displaystyle \frac{\partial f}{\partial y}$对任意的$(x,y)$也是连续且可微的！）</font>。分析理论中常用的一个策略是交换两个偏导数的次序，从而我们期望得到：
$$
\frac{\partial^2 f}{\partial y\partial x}(0,0)=\frac{\partial^2 f}{\partial x\partial y}(0,0)
$$
但是根据商的求导法则，我们得到：
$$
\frac{\partial f}{\partial y}(x,y)=\frac{3xy^2}{x^2+y^2}-\frac{2xy^4}{(x^2+y^2)^2}
$$
特别的，
$$
\frac{\partial f}{\partial y}(0,0)=\frac{0}{x^2}-\frac{0}{x^4}=0
$$
于是：
$$
\frac{\partial^2 f}{\partial x\partial y}(0,0)=0
$$
另外，同样根据商的求导法则可以得到：
$$
\frac{\partial f}{\partial x}(x,y)=\frac{y^3}{x^2+y^2}-\frac{2x^2y^3}{(x^2+y^2)^2}
$$
进而有：
$$
\frac{\partial f}{\partial x}(0,y)=\frac{y^3}{y^2}-\frac{0}{y^4}=y
$$
因此：
$$
\frac{\partial^2 f}{\partial y\partial x}(0,0)=1
$$
由于$1\ne 0$，所以我们似乎已经推出了这样一个结论：交换求导次序是不可信的。然而，是否存在某些其他情况使得交换求导次序可以成立？<font color=blue>（定理11.37.4和习题11.37.1给出了一些回答）</font>

------

### 例1.2.12 洛必达法则

我们都很熟悉简洁优美的洛必达法则：
$$
\lim_{x\to x_0}\frac{f(x)}{g(x)}=\lim_{x\to x_0}\frac{f'(x)}{g'(x)}
$$
但是如果不正确应用该法则，仍旧会导致错误出现。例如，当 $f(x):=x$，$g(x):=1+x$以及 $x_0:=0$ 时，应用洛必达法则可以得到：
$$
\lim_{x\to 0}\frac{x}{1+x}=\lim_{x\to 0}\frac{1}{1}=1
$$
但是，因为$\displaystyle\lim_{x\to 0}\frac{x}{1+x}=\frac{0}{1+0}=0$，所以这个结果是不正确的。显然，只有当$x\to x_0$，$f(x)$和$g(x)$均趋向于$0$时，洛必达法则才适用，而上面的这个例子却没有满足该条件。但是即便当$x\to x_0$，$f(x)$和$g(x)$均趋向于$0$时，仍然存在出现错误结果的可能。例如，考虑如下极限：
$$
\lim_{x\to 0}\frac{x^2\sin(x^{-4})}{x}
$$
因此当$x\to 0$时，分子和分母都趋向于$0$，所以该极限似乎可以放心地使用洛必达发则，从而得到：
$$
\begin{flalign}\lim_{x\to 0}\frac{x^2\sin(x^{-4})}{x}&=\lim_{x\to 0}\frac{2x\sin(x^{-4})-4x^{-3}\cos(x^{-4})}{1}\\&=\lim_{x\to 0}2x\sin(x^{-4})-\lim_{x\to 0}4x^{-3}\cos(x^{-4})\end{flalign}
$$
根据夹逼定理可知，第一个极限收敛于$0$ <font color=blue>（因为函数$2x\sin(x^{-4})$有上界$2|x|$和下界$-2|x|$，并且当$x\to 0$时，$2|x|$和$-2|x|$都是趋向于$0$的）</font>，都是第二个极限却是发散的<font color=blue>（因为当$x\to 0$时，$x^{-3}$趋向于无穷且$\cos(x^{-4})$不趋向于$0$）</font>。因此，极限 $\lim\limits_{x\to 0}\frac{2x\sin(x^{-4})-4x^{-3}\cos(x^{-4})}{1}$发散。于是，有人可能会根据洛必达法则推出 $\lim\limits_{x\to 0}\frac{x^2\sin(x^{-4})}{x}$也是发散的。但是我们可以聪明地把这个极限改写成 $\lim\limits_{x\to 0}x\sin(x^{-4})$，那么根据夹逼定理，当$x\to 0$时，该极限是趋向于$0$的。这并非说明洛必达法则不可信<font color=blue>（事实上，洛必达法则是非常严格的，见[10.5节](..\..\第10章\md\实分析 10.5 洛必达法则.md)），而是告诉我们在使用它的时候需要更加小心）</font>

---

### 例1.2.13 极限和长度

当你学习积分以及积分与一条曲线下方面积之间关系的时候，将会有一幅图形展现在你的眼前。在这幅图形中，某条曲线下方的区域将由许多矩形来逼近，而且这部分矩形的面积由黎曼和给出。然后我们可以通过“取极限”的方式把上述黎曼和用积分代替，那么得到的这个积分值就被近似看作该曲线下方区域的实际面积。之后不久，你将学会采用类似的方法求出一条曲线的长度——用许多线段来逼近一条曲线，计算出所有线段长度之和，进而通过取极限得到该曲线的长度。

然而，你现在不难想到如果没有正确地运用上述方法，也会导致荒谬的结果。考虑顶点为$(0,0)$、$(1,0)$和$(0,1)$ 的直角三角形，并且假设我们希望求出该三角形斜边的长度。利用毕达哥拉斯定理，我们能够计算出斜边的长度为$\sqrt 2$。然而，假设由于某些原因我们并不知道毕达哥拉斯定理，并且希望通过微积分的方法求出斜边的长度。那么，一种方法就是利用水平边和垂直边来逼近斜边。取定一个较大的数字 $N$，然后构造出一个“阶梯”来逼近斜边。这个“阶梯”有$N$个长度相等的水平边，并且这些水平边与$N$个长度相同的垂直边交替排列。显然，所有边的长度均为$\frac1N$，那么这个阶梯的总长度为$\frac{2N}{N}= 2$。如果令Ⅳ趋向于无穷，那么显然该阶梯趋近于斜边。因此，在极限概念下，我们应该可以得到斜边的长度。但是，当$N \to  \infty$时，$\frac{2N}{N}$的极限值为$2$，而非$\sqrt2$，所以我们得到的斜边长度是错误的。这种状况是如何发生的?

---

## 后记

看完上面的例题之后，想必你已经能对分析理论的重要性有一个大致的理解。学习本书中的分析理论，将有助于你解决上面的问题，了解这些法则在什么情况下是适用的，从而引领你避开谬误，能更好的应用这些法则。另外，学习分析理论的过程中，也需要养成一种“分析的思维方式”，当你面对一些新的领域与法则时，这样的思考方式能对你有所帮助。例如，当你面对复值函数，不连续函数的时候，你也能借助这样分析的思维去思考法则的适用性，如何将已有的法则推广到新的领域，这样的推广又有怎样的限制。这样，你可以更加自信而严谨的使用你所熟知的数学知识。
